[
  {
    "category": "Grundlagen Computergrafik",
    "type": "2D",
    "title": "Bresenham",
    "modelPath": "models/Cube.glb",
    "hints": [
      "Nutze Ganzzahllogik, um Linienpixel zu setzen"
    ],
    "task": "<p>Implementiere den Bresenham-Linienalgorithmus</p>\n",
    "theory": "<h2>1. Ausgangspunkt: die ideale Linie</h2>\n<p>Eine Linie zwischen zwei Punkten <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>0</mn></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x_0, y_0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> und <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x_1, y_1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> kann in der Steigungsform geschrieben werden:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>m</mi><mo>⋅</mo><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">\ny = m \\cdot x + b\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span></span></p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mfrac><mrow><msub><mi>y</mi><mn>1</mn></msub><mo>−</mo><msub><mi>y</mi><mn>0</mn></msub></mrow><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><msub><mi>x</mi><mn>0</mn></msub></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">m = \\frac{y_1 - y_0}{x_1 - x_0}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2995em;vertical-align:-0.4451em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8544em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4461em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4451em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span> → Steigung  </li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi><mo>=</mo><msub><mi>y</mi><mn>0</mn></msub><mo>−</mo><mi>m</mi><mo>⋅</mo><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">b = y_0 - m \\cdot x_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> → y-Achsenabschnitt</li>\n</ul>\n<blockquote>\n<p>Das ist die &quot;perfekte&quot; Linie in kontinuierlichen Koordinaten.</p>\n</blockquote>\n<hr>\n<h2>2. Problem: Raster / Pixel</h2>\n<p>Auf einem Bildschirm oder Raster können wir <strong>nur Pixel mit ganzzahligen Koordinaten setzen</strong>.  </p>\n<ul>\n<li>Wir müssen entscheiden, <strong>welches Pixel in jeder Spalte gesetzt wird</strong>, um der Linie möglichst genau zu folgen.  </li>\n<li>Einfaches Runden der Gleitkommawerte ist möglich, aber <strong>langsam</strong>, weil es Multiplikationen und Rundungen benötigt.</li>\n</ul>\n<hr>\n<h2>3. Schrittweise Annäherung</h2>\n<p>Betrachte die Linie Schritt für Schritt von <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> nach <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>:  </p>\n<ul>\n<li>Aktuelles Pixel: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x, y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>  </li>\n<li>Ideale Linie: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>y</mi><mtext>ideal</mtext></msub><mo>=</mo><mi>m</mi><mo>⋅</mo><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">y_\\text{ideal} = m \\cdot x + b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">ideal</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4445em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>  </li>\n<li>Wir müssen entscheiden: <strong>y bleibt gleich oder y wird um 1 erhöht?</strong></li>\n</ul>\n<hr>\n<h2>4. Differenzen definieren</h2>\n<p>Wir berechnen die Differenzen:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"normal\">Δ</mi><mi>x</mi><mo>=</mo><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><msub><mi>x</mi><mn>0</mn></msub><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mi mathvariant=\"normal\">Δ</mi><mi>y</mi><mo>=</mo><msub><mi>y</mi><mn>1</mn></msub><mo>−</mo><msub><mi>y</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">\n\\Delta x = x_1 - x_0, \\quad \\Delta y = y_1 - y_0\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Δ</mi><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">\\Delta x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\">x</span></span></span></span> = horizontale Länge  </li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Δ</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">\\Delta y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> = vertikale Länge</li>\n</ul>\n<p>Die Steigung der Linie ist <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mfrac><mrow><mi mathvariant=\"normal\">Δ</mi><mi>y</mi></mrow><mrow><mi mathvariant=\"normal\">Δ</mi><mi>x</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">m = \\frac{\\Delta y}{\\Delta x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2694em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9244em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">Δ</span><span class=\"mord mathnormal mtight\">x</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.4461em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">Δ</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>.  </p>\n<hr>\n<h2>5. Fehlerbegriff</h2>\n<p>Wir definieren einen <strong>Fehler</strong>:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>Fehler</mtext><mo>=</mo><msub><mi>y</mi><mtext>ideal</mtext></msub><mo>−</mo><msub><mi>y</mi><mtext>aktuell</mtext></msub></mrow><annotation encoding=\"application/x-tex\">\n\\text{Fehler} = y_\\text{ideal} - y_\\text{aktuell}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord text\"><span class=\"mord\">Fehler</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">ideal</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">aktuell</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<ul>\n<li>Wenn Fehler &gt; 0 → die Linie liegt <strong>über</strong> der Pixelmitte → y muss erhöht werden.  </li>\n<li>Wenn Fehler ≤ 0 → die Linie liegt <strong>unterhalb</strong> oder auf der Pixelmitte → y bleibt gleich.</li>\n</ul>\n<h3>5.1. Problem: Gleitkomma vermeiden</h3>\n<ul>\n<li>Um nur mit <strong>Ganzzahlen</strong> zu rechnen, multiplizieren wir alles mit <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Δ</mi><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">\\Delta x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\">x</span></span></span></span>, um den Bruch <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Δ</mi><mi>y</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">Δ</mi><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">\\Delta y / \\Delta x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\">/Δ</span><span class=\"mord mathnormal\">x</span></span></span></span> zu eliminieren:</li>\n</ul>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"normal\">Δ</mi><mi>x</mi><mo>⋅</mo><mtext>Fehler</mtext><mo>=</mo><mi mathvariant=\"normal\">Δ</mi><mi>x</mi><mo>⋅</mo><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mtext>ideal</mtext></msub><mo>−</mo><msub><mi>y</mi><mtext>aktuell</mtext></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">Δ</mi><mi>y</mi><mo>⋅</mo><mo stretchy=\"false\">(</mo><mi>x</mi><mo>−</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo><mo>+</mo><mi mathvariant=\"normal\">Δ</mi><mi>x</mi><mo>⋅</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo><mo>−</mo><mi mathvariant=\"normal\">Δ</mi><mi>x</mi><mo>⋅</mo><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">\n\\Delta x \\cdot \\text{Fehler} = \\Delta x \\cdot (y_\\text{ideal} - y_\\text{aktuell}) \n= (\\Delta y \\cdot (x - x_0) + \\Delta x \\cdot y_0) - \\Delta x \\cdot y\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord text\"><span class=\"mord\">Fehler</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">ideal</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">aktuell</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span></p>\n<ul>\n<li>Definiere den <strong>entscheidenden Ganzzahl-Fehlerterm</strong>:</li>\n</ul>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>D</mi><mo>=</mo><mn>2</mn><mi mathvariant=\"normal\">Δ</mi><mi>y</mi><mo>−</mo><mi mathvariant=\"normal\">Δ</mi><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">\nD = 2 \\Delta y - \\Delta x\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\">2Δ</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\">x</span></span></span></span></span></p>\n<blockquote>\n<p>Durch geschicktes Multiplizieren mit <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mi mathvariant=\"normal\">Δ</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">2 \\Delta y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\">2Δ</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> und <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Δ</mi><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">\\Delta x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\">x</span></span></span></span> können wir <strong>nur Ganzzahlen verwenden</strong>, ohne Gleitkomma.</p>\n</blockquote>\n<hr>\n<h2>6. Iteration mit dem Fehlerterm</h2>\n<p>Für jede Spalte <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> (von <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> bis <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">x_1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>):</p>\n<ol>\n<li>Zeichne Pixel <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x, y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>  </li>\n<li>Prüfe den Fehlerterm <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span>:  <ul>\n<li>Wenn <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">D &gt; 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7224em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>: Pixel in <strong>y-Richtung erhöhen</strong>, und Fehler anpassen: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi><mo>=</mo><mi>D</mi><mo>−</mo><mn>2</mn><mi mathvariant=\"normal\">Δ</mi><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">D = D - 2 \\Delta x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">2Δ</span><span class=\"mord mathnormal\">x</span></span></span></span>  </li>\n<li>Immer: Fehler erhöhen: <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi><mo>=</mo><mi>D</mi><mo>+</mo><mn>2</mn><mi mathvariant=\"normal\">Δ</mi><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">D = D + 2 \\Delta y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\">2Δ</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></li>\n</ul>\n</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span> wird immer um 1 erhöht (oder <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span> bei steilen Linien)</li>\n</ol>\n<hr>\n<h2>7. Steile Linien</h2>\n<ul>\n<li>Wenn <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><mi mathvariant=\"normal\">Δ</mi><mi>y</mi><mi mathvariant=\"normal\">∣</mi><mo>&gt;</mo><mi mathvariant=\"normal\">∣</mi><mi mathvariant=\"normal\">Δ</mi><mi>x</mi><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">|\\Delta y| &gt; |\\Delta x|</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣Δ</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣Δ</span><span class=\"mord mathnormal\">x</span><span class=\"mord\">∣</span></span></span></span> → Linie steiler als 45°  </li>\n<li>Lösung: <strong>x und y tauschen</strong>, Algorithmus unverändert  </li>\n<li>Vorzeichen berücksichtigen:</li>\n</ul>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>s</mi><mi>x</mi></msub><mo>=</mo><mtext>sign</mtext><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mspace width=\"1em\"/><msub><mi>s</mi><mi>y</mi></msub><mo>=</mo><mtext>sign</mtext><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>−</mo><msub><mi>y</mi><mn>0</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\ns_x = \\text{sign}(x_1 - x_0), \\quad s_y = \\text{sign}(y_1 - y_0)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">sign</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0361em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">sign</span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span></p>\n<ul>\n<li>Damit funktioniert der Algorithmus in allen vier Richtungen.</li>\n</ul>\n<hr>\n<h2>8. Zusammenfassung</h2>\n<ul>\n<li>Fehlerterm <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>D</mi></mrow><annotation encoding=\"application/x-tex\">D</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span></span></span> misst <strong>Abweichung der idealen Linie vom aktuellen Pixel</strong>  </li>\n<li>Entscheidung: <strong>Pixel in y-Richtung erhöhen oder nicht</strong>  </li>\n<li>Nur Ganzzahlen → sehr effizient  </li>\n<li>Ergebnis: <strong>pixelgenaue Linie</strong>, die der idealen Linie sehr nahekommt</li>\n</ul>\n",
    "starterVertexShader": "precision highp float;\n\nin vec3 position;\nin vec3 normal;\nin vec2 uv;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat3 normalMatrix;\n\nout vec2 vUV;\n\nvoid main() {\n    vUV = uv;\n    gl_Position = vec4(position, 1.0);\n}",
    "starterFragmentShader": "precision highp float;\n\nin vec2 vUV;\nout vec4 fragColor;\n\nuniform vec2 iResolution;\n\nconst int GRID_SIZE = 32;\n\n// Convert from UV (0–1) to aspect-corrected space (-1–1)\nvec2 aspectCorrectUV(vec2 uv) {\n    vec2 p = uv * 2.0 - 1.0;\n    p.x *= iResolution.x / iResolution.y;\n    return p;\n}\n\n// Convert pixel grid coordinate to aspect-corrected UV space (-1..1)\nvec2 gridToUV(int x, int y) {\n    vec2 p = (vec2(float(x), float(y)) / float(GRID_SIZE)) * 2.0 - 1.0;\n    p.x *= iResolution.x / iResolution.y;\n    return p;\n}\n\n// Determine if the fragment lies inside a grid pixel (square)\nbool isInsidePixel(vec2 uv, int x, int y) {\n    // Compute bounds in aspect-corrected space\n    vec2 minP = gridToUV(x, y);\n    vec2 maxP = gridToUV(x + 1, y + 1);\n\n    // Compute fragment position\n    vec2 f = aspectCorrectUV(uv);\n\n    return all(greaterThanEqual(f, minP)) && all(lessThan(f, maxP));\n}\n\n// Draw a single pixel cell with color\nvoid drawPixel(int x, int y, inout vec3 color, vec3 pixelColor) {\n    if (isInsidePixel(vUV, x, y)) {\n        color = pixelColor;\n    }\n}\n\n// Integer Bresenham line\nvoid bresenhamLine(int x0, int y0, int x1, int y1, inout vec3 color) {\n\n}\n\nvoid main() {\n    vec3 color = vec3(0.12); // dark gray background\n\n    // Optional grid lines (1px thin)\n    vec2 uv = vUV * float(GRID_SIZE);\n    vec2 gridLine = smoothstep(0.98, 1.0, abs(fract(uv) - 0.5) * 2.0);\n    float gridMask = min(gridLine.x, gridLine.y);\n    color = mix(vec3(0.15), color, gridMask);\n\n    // Define line endpoints in grid coordinates\n    int x0 = int(0.05 * float(GRID_SIZE));\n    int y0 = int(0.25 * float(GRID_SIZE));\n    int x1 = int(0.95 * float(GRID_SIZE));\n    int y1 = int(0.85 * float(GRID_SIZE));\n\n    // Draw Bresenham line\n    bresenhamLine(x0, y0, x1, y1, color);\n\n    fragColor = vec4(color, 1.0);\n}",
    "referenceVertexShader": "precision highp float;\n\nin vec3 position;\nin vec3 normal;\nin vec2 uv;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat3 normalMatrix;\n\nout vec2 vUV;\n\nvoid main() {\n    vUV = uv;\n    gl_Position = vec4(position, 1.0);\n}",
    "referenceFragmentShader": "precision highp float;\n\nin vec2 vUV;\nout vec4 fragColor;\n\nuniform vec2 iResolution;\n\nconst int GRID_SIZE = 64;\n\n// Convert from UV (0–1) to aspect-corrected space (-1–1)\nvec2 aspectCorrectUV(vec2 uv) {\n    vec2 p = uv * 2.0 - 1.0;\n    p.x *= iResolution.x / iResolution.y;\n    return p;\n}\n\n// Convert pixel grid coordinate to aspect-corrected UV space (-1..1)\nvec2 gridToUV(int x, int y) {\n    vec2 p = (vec2(float(x), float(y)) / float(GRID_SIZE)) * 2.0 - 1.0;\n    p.x *= iResolution.x / iResolution.y;\n    return p;\n}\n\n// Determine if the fragment lies inside a grid pixel (square)\nbool isInsidePixel(vec2 uv, int x, int y) {\n    // Compute bounds in aspect-corrected space\n    vec2 minP = gridToUV(x, y);\n    vec2 maxP = gridToUV(x + 1, y + 1);\n\n    // Compute fragment position\n    vec2 f = aspectCorrectUV(uv);\n\n    return all(greaterThanEqual(f, minP)) && all(lessThan(f, maxP));\n}\n\n// Draw a single pixel cell with color\nvoid drawPixel(int x, int y, inout vec3 color, vec3 pixelColor) {\n    if (isInsidePixel(vUV, x, y)) {\n        color = pixelColor;\n    }\n}\n\n// Integer Bresenham line\nvoid bresenhamLine(int x0, int y0, int x1, int y1, inout vec3 color) {\n    int dx = abs(x1 - x0);\n    int sx = x0 < x1 ? 1 : -1;\n    int dy = -abs(y1 - y0);\n    int sy = y0 < y1 ? 1 : -1;\n    int err = dx + dy;\n    int e2;\n\n    int x = x0;\n    int y = y0;\n\n    for (int i = 0; i < 512; i++) { // safety loop\n        drawPixel(x, y, color, vec3(1.0, 0.0, 0.0)); // red pixel\n\n        if (x == x1 && y == y1) break;\n\n        e2 = 2 * err;\n        if (e2 >= dy) { err += dy; x += sx; }\n        if (e2 <= dx) { err += dx; y += sy; }\n    }\n}\n\nvoid main() {\n    vec3 color = vec3(0.12); // dark gray background\n\n    // Define line endpoints in grid coordinates\n    int x0 = int(0.05 * float(GRID_SIZE));\n    int y0 = int(0.25 * float(GRID_SIZE));\n    int x1 = int(0.95 * float(GRID_SIZE));\n    int y1 = int(0.85 * float(GRID_SIZE));\n\n    // Draw Bresenham line\n    bresenhamLine(x0, y0, x1, y1, color);\n\n    fragColor = vec4(color, 1.0);\n}"
  },
  {
    "category": "Grundlagen Computergrafik",
    "type": "3D",
    "title": "Lambert",
    "modelPath": "models/HeadDavid.glb",
    "hints": [
      "Transformiere die Normalen korrekt mit der `normalMatrix` für eine richtige Beleuchtung",
      "Berechne den Diffusfaktor mit dot(normal, lightDir)",
      "Klippe den Diffuswert mit max(), um negative Beleuchtung zu vermeiden",
      "Multipliziere die Basisfarbe mit dem Diffusfaktor, um die endgültige Beleuchtung zu erhalten"
    ],
    "task": "<p>Erstelle ein Programm, das diffuse Beleuchtung basierend auf einer Richtungslichtquelle implementiert.  </p>\n<ul>\n<li>erster Stichpunkt</li>\n<li>zweiter Stichpunkt</li>\n</ul>\n",
    "theory": "<p>Lambert-Beleuchtung ist ein einfaches Modell für diffuse Lichtberechnung, bei dem die Helligkeit einer Oberfläche vom Winkel zwischen der <strong>Oberflächennormalen</strong> und der <strong>Richtung der Lichtquelle</strong> abhängt.</p>\n<p>In <strong>GLSL</strong> werden die Normalen der Vertices über <code>out</code>-Variablen an den Fragment-Shader weitergegeben. Der diffuse Beleuchtungsfaktor wird als <strong>Skalarprodukt</strong> zwischen der normalisierten Normalen und der normalisierten Licht-Richtung berechnet:</p>\n",
    "starterVertexShader": "precision highp float;\n\nin vec3 position;\nin vec3 normal;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat3 normalMatrix;\n\nout vec3 vNormal;\n\nvoid main() {\n  // transform normal to view space and pass to fragment shader\n  vNormal = normalize(normalMatrix * normal);\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",
    "starterFragmentShader": "precision highp float;\n\nin vec3 vNormal;\nout vec4 fragColor;\n\nvoid main() {\n  // simple placeholder white color\n  fragColor = vec4(0.18, 0.18, 0.18, 1.0);\n}",
    "referenceVertexShader": "precision highp float;\n\nin vec3 position;\nin vec3 normal;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat3 normalMatrix;\n\nout vec3 vNormal;\n\nvoid main() {\n  vNormal = normalize(normalMatrix * normal);\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",
    "referenceFragmentShader": "precision highp float;\n\nin vec3 vNormal;\nout vec4 fragColor;\n\nvoid main() {\n  vec3 lightDir = normalize(vec3(1.0, 1.0, 1.0));\n  vec3 baseColor = vec3(0.8, 0.4, 0.2);\n  float diffuse = max(dot(vNormal, lightDir), 0.0);\n  vec3 color = baseColor * diffuse;\n  fragColor = vec4(color, 1.0);\n}"
  },
  {
    "category": "Grundlagen Computergrafik",
    "type": "3D",
    "title": "Phong",
    "modelPath": "models/HeadDavid.glb",
    "hints": [
      "Transformiere die Normalen korrekt mit der `normalMatrix` für eine richtige Beleuchtung",
      "Berechne die diffuse Komponente mit `dot(normal, lightDir)` und clamp sie mit `max()`",
      "Berechne die specular Komponente mit `pow(max(dot(reflectDir, viewDir), 0.0), shininess)`",
      "Addiere ambient, diffuse und specular Komponente, um die endgültige Beleuchtung zu erhalten"
    ],
    "task": "<p>Erstelle ein Programm, das <strong>Phong-Beleuchtung</strong> basierend auf einer Richtungslichtquelle implementiert.  </p>\n<ul>\n<li>erster Stichpunkt</li>\n<li>zweiter Stichpunkt</li>\n</ul>\n",
    "theory": "<p>Phong-Beleuchtung ist ein Modell für diffuse und spiegelnde Beleuchtung. Die Helligkeit einer Oberfläche hängt von drei Komponenten ab:</p>\n<ol>\n<li><strong>Ambient</strong>: Grundhelligkeit der Szene</li>\n<li><strong>Diffuse</strong>: Helligkeit basierend auf dem Winkel zwischen Normalen und Lichtquelle</li>\n<li><strong>Specular</strong>: Glanzlichter basierend auf dem Winkel zwischen reflektiertem Licht und Blickrichtung</li>\n</ol>\n<p>In <strong>GLSL</strong> werden die Normalen der Vertices über <code>out</code>-Variablen an den Fragment-Shader weitergegeben. Diffuse und specular werden berechnet und dann mit der Basisfarbe kombiniert.</p>\n",
    "starterVertexShader": "precision highp float;\n\nin vec3 position;\nin vec3 normal;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat3 normalMatrix;\n\nout vec3 vNormal;\nout vec3 vPosition;\n\nvoid main() {\n    vNormal = normalize(normalMatrix * normal);\n    vPosition = vec3(modelViewMatrix * vec4(position, 1.0));\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",
    "starterFragmentShader": "precision highp float;\n\nin vec3 vNormal;\nin vec3 vPosition;\n\nout vec4 fragColor;\n\nvoid main() {\n    fragColor = vec4(0.18, 0.18, 0.18, 1.0);\n}",
    "referenceVertexShader": "precision highp float;\n\nin vec3 position;\nin vec3 normal;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat3 normalMatrix;\n\nout vec3 vNormal;\nout vec3 vPosition;\n\nvoid main() {\n    vNormal = normalize(normalMatrix * normal);\n    vPosition = vec3(modelViewMatrix * vec4(position, 1.0));\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",
    "referenceFragmentShader": "precision highp float;\n\nin vec3 vNormal;\nin vec3 vPosition;\n\nout vec4 fragColor;\n\nvoid main() {\n    vec3 lightDir = normalize(vec3(1.0, 1.0, 1.0));\n    vec3 viewDir = normalize(-vPosition);\n    vec3 baseColor = vec3(0.8, 0.4, 0.2);\n\n    // Diffuse component\n    float diffuse = max(dot(vNormal, lightDir), 0.0);\n\n    // Specular component\n    vec3 reflectDir = reflect(-lightDir, vNormal);\n    float specular = pow(max(dot(reflectDir, viewDir), 0.0), 32.0);\n\n    // Ambient component\n    vec3 ambient = vec3(0.1);\n\n    vec3 color = ambient + baseColor * diffuse + specular * vec3(1.0);\n    fragColor = vec4(color, 1.0);\n}"
  },
  {
    "category": "Grundlagen Computergrafik",
    "type": "3D",
    "title": "Planeten System",
    "modelPath": "models/Sphere.glb",
    "instanceCount": 10,
    "hints": [
      "Verwende gl_InstanceID, um zwischen den Planeten im Shader zu unterscheiden.",
      {
        "Die Reihenfolge der Matrixmultiplikation ist entscheidend": "Translation * Rotation * Skalierung wendet die Skalierung zuerst an."
      },
      {
        "Um eine Hierarchie zu schaffen (z.B. Mond um Erde), multipliziere die Transformation des Kindes mit der des Elternteils": "earthMatrix * moonMatrix."
      },
      "Benutze den time-Uniform, um die Rotationswinkel zu animieren."
    ],
    "task": "<p>Erstelle ein hierarchisches Planetensystem (Sonne, Erde, Mond) mithilfe von Instancing. Alle Transformationslogiken, wie Rotation und Translation, sollen direkt im Vertex-Shader unter Verwendung von Matrizen und dem gl_InstanceID implementiert werden.</p>\n",
    "theory": "<p>Hierarchische Transformationen ermöglichen es, Objekte relativ zueinander zu positionieren und zu bewegen. In der Computergrafik wird dies durch die Multiplikation von Transformationsmatrizen erreicht.</p>\n<p>Ein Objekt (z.B. der Mond) kann an ein anderes Objekt (die Erde) &quot;gebunden&quot; werden, indem seine eigene lokale Transformation (Rotation und Abstand zur Erde) mit der Transformation des Elternobjekts (die Position der Erde im Sonnensystem) multipliziert wird.</p>\n<p>Die finale Transformationsmatrix für den Mond wäre also:\nfinalMoonMatrix = projectionMatrix * viewMatrix * earthMatrix * localMoonMatrix</p>\n<p>Indem wir dies für jede Instanz im Vertex-Shader tun, können wir mit einem einzigen Draw-Call ein ganzes, animiertes System rendern.</p>\n",
    "starterVertexShader": "precision highp float;\n\nin vec3 position;\nin vec3 normal;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float time;\n\nout vec3 vNormal;\nout vec3 vColor;\n\nvoid main() {\n    if (gl_InstanceID == 0) {\n        // --- Sonne ---\n\n    } else if (gl_InstanceID == 1) {\n        // --- Erde ---\n\n    } else if (gl_InstanceID == 2) {\n        // --- Mond ---\n   \n    }\n\n    vColor = vec3(1.0, 0.8, 0.2);\n    vNormal = normal;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",
    "starterFragmentShader": "precision highp float;\n\nin vec3 vNormal;\nin vec3 vColor; // Farbe vom Vertex Shader empfangen\n\nout vec4 fragColor;\n\nvoid main() {\n    vec3 lightDir = normalize(vec3(0.5, 0.5, 1.0)); // world-space light\n    float diffuse = max(dot(normalize(vNormal), lightDir), 0.0);\n        \n    // Umgebungslicht, damit die dunkle Seite nicht komplett schwarz ist\n    float ambient = 0.2;\n    \n    // Farbe mit Beleuchtung kombinieren\n    vec3 finalColor = vColor * (diffuse + ambient);\n    \n    fragColor = vec4(finalColor, 1.0);\n}",
    "referenceVertexShader": "precision highp float;\n\nin vec3 position;\nin vec3 normal;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float time;\n\nout vec3 vNormal;\nout vec3 vColor;\n\n// Helper functions\nmat4 translation(vec3 t) {\n    return mat4(\n        1.0, 0.0, 0.0, 0.0,\n        0.0, 1.0, 0.0, 0.0,\n        0.0, 0.0, 1.0, 0.0,\n        t.x, t.y, t.z, 1.0\n    );\n}\n\nmat4 scale(vec3 s) {\n    return mat4(\n        s.x, 0.0, 0.0, 0.0,\n        0.0, s.y, 0.0, 0.0,\n        0.0, 0.0, s.z, 0.0,\n        0.0, 0.0, 0.0, 1.0\n    );\n}\n\nmat4 rotationY(float angle) {\n    float c = cos(angle);\n    float s = sin(angle);\n    return mat4(\n        c, 0.0, s, 0.0,\n        0.0, 1.0, 0.0, 0.0,\n        -s, 0.0, c, 0.0,\n        0.0, 0.0, 0.0, 1.0\n    );\n}\n\nvoid main() {\nmat4 modelMatrix = mat4(1.0);\n\n// Declare variables for artistic scale and orbital speed\nfloat planetScale = 0.25;  // default, overridden below\nfloat speed = 0.0;   // default, overridden below\n\nif (gl_InstanceID == 0) {\n    // Sun\n    vColor = vec3(1.0, 0.8, 0.2);\n    planetScale = 2.0;\n    modelMatrix = scale(vec3(planetScale));\n\n} else if (gl_InstanceID == 1) {\n    // Earth\n    vColor = vec3(0.2, 0.4, 1.0);\n    planetScale = 0.7;\n    speed = 1.0;\n    modelMatrix = rotationY(time * speed) * translation(vec3(5.0, 0.0, 0.0)) * scale(vec3(planetScale));\n\n} else if (gl_InstanceID == 2) {\n    // Moon\n    vColor = vec3(0.5, 0.5, 0.5);\n    planetScale = 0.25;\n    speed = 12.0; // fast around Earth\n    mat4 earthMatrix = rotationY(time * 1.0) * translation(vec3(5.0, 0.0, 0.0));\n    mat4 moonMatrix  = rotationY(time * speed) * translation(vec3(1.5, 0.0, 0.0)) * scale(vec3(planetScale));\n    modelMatrix = earthMatrix * moonMatrix;\n\n} else if (gl_InstanceID == 3) {\n    // Mercury\n    vColor = vec3(0.8, 0.6, 0.4);\n    planetScale = 0.3;\n    speed = 4.15;\n    modelMatrix = rotationY(time * speed) * translation(vec3(3.0, 0.0, 0.0)) * scale(vec3(planetScale));\n\n} else if (gl_InstanceID == 4) {\n    // Venus\n    vColor = vec3(1.0, 0.7, 0.3);\n    planetScale = 0.5;\n    speed = 1.62;\n    modelMatrix = rotationY(time * speed) * translation(vec3(4.0, 0.0, 0.0)) * scale(vec3(planetScale));\n\n} else if (gl_InstanceID == 5) {\n    // Mars\n    vColor = vec3(1.0, 0.3, 0.2);\n    planetScale = 0.5;\n    speed = 0.53;\n    modelMatrix = rotationY(time * speed) * translation(vec3(7.0, 0.0, 0.0)) * scale(vec3(planetScale));\n\n} else if (gl_InstanceID == 6) {\n    // Jupiter\n    vColor = vec3(1.0, 0.9, 0.6);\n    planetScale = 1.5;\n    speed = 0.08;\n    modelMatrix = rotationY(time * speed) * translation(vec3(10.0, 0.0, 0.0)) * scale(vec3(planetScale));\n\n} else if (gl_InstanceID == 7) {\n    // Saturn\n    vColor = vec3(0.9, 0.8, 0.5);\n    planetScale = 1.2;\n    speed = 0.03;\n    modelMatrix = rotationY(time * speed) * translation(vec3(13.0, 0.0, 0.0)) * scale(vec3(planetScale));\n\n} else if (gl_InstanceID == 8) {\n    // Uranus\n    vColor = vec3(0.5, 0.9, 1.0);\n    planetScale = 1.0;\n    speed = 0.01;\n    modelMatrix = rotationY(time * speed) * translation(vec3(16.0, 0.0, 0.0)) * scale(vec3(planetScale));\n\n} else if (gl_InstanceID == 9) {\n    // Neptune\n    vColor = vec3(0.3, 0.5, 1.0);\n    planetScale = 0.95;\n    speed = 0.006;\n    modelMatrix = rotationY(time * speed) * translation(vec3(19.0, 0.0, 0.0)) * scale(vec3(planetScale));\n}\n\n// Normals\nmat3 normalMatrix = mat3(transpose(inverse(modelMatrix)));\nvNormal = normalize(normalMatrix * normal);\ngl_Position = projectionMatrix * modelViewMatrix * modelMatrix * vec4(position, 1.0);\n}",
    "referenceFragmentShader": "precision highp float;\n\nin vec3 vNormal;\nin vec3 vColor; // Farbe vom Vertex Shader empfangen\n\nout vec4 fragColor;\n\nvoid main() {\n    vec3 lightDir = normalize(vec3(0.5, 0.5, 1.0)); // world-space light\n    float diffuse = max(dot(normalize(vNormal), lightDir), 0.0);\n        \n    // Umgebungslicht, damit die dunkle Seite nicht komplett schwarz ist\n    float ambient = 0.2;\n    \n    // Farbe mit Beleuchtung kombinieren\n    vec3 finalColor = vColor * (diffuse + ambient);\n    \n    fragColor = vec4(finalColor, 1.0);\n}"
  },
  {
    "category": "Computer Animation",
    "type": "2D",
    "inputs": [
      {
        "name": "volumeTexture",
        "type": "texture3D",
        "init": "textures/CTVolumeAtlas.raw"
      }
    ],
    "title": "Volumetric Raymarching",
    "hints": null,
    "task": "<p>Wir bauen einen Volume Renderer basierend auf der Pipeline von Marc Levoy. Hilfsfunktionen für Gradienten und Beleuchtung sind bereits gegeben.</p>\n<h2>Aufgaben</h2>\n<ol>\n<li><p><strong>Orthographic Ray Generation</strong></p>\n<ul>\n<li>Bestimmen Sie Startpunkt (<code>rayOrigin</code>) und Richtung (<code>rayDirection</code>) des Strahls.</li>\n<li><em>Feedback:</em> Sobald dies implementiert ist, wechselt die Ansicht automatisch von &quot;UV-Gradient&quot; zu &quot;Ray-Koordinaten&quot; (Bunt).</li>\n</ul>\n</li>\n<li><p><strong>Raymarching Loop</strong></p>\n<ul>\n<li>Implementieren Sie die Schleife, die das Volumen abtastet.</li>\n<li><em>Feedback:</em> Sobald der Loop läuft, sehen Sie den Kopf im Viewport.</li>\n</ul>\n</li>\n<li><p><strong>Transfer Function</strong></p>\n<ul>\n<li>Implementieren Sie die Transfer Funktion, um Dichtewerte in Farben zu übersetzen (Luft, Gewebe, Knochen).</li>\n<li><em>Ergebnis:</em> Ein korrektes, eingefärbtes CT-Bild (Haut &amp; Knochen).</li>\n</ul>\n</li>\n</ol>\n<h2>Nützliches zur Programmierung</h2>\n<h3><strong>Vektoren und Skalare</strong></h3>\n<ul>\n<li><code>vec3</code> = 3 Komponenten, <code>vec4</code> = 4 Komponenten  </li>\n<li>Zugriff auf Komponenten: <code>.x</code>, <code>.y</code>, <code>.z</code> oder <code>.r</code>, <code>.g</code>, <code>.b</code>  oder <code>.rgb</code></li>\n<li>Ganze Vektoren oder einzelne Komponenten können mit Skalaren multipliziert oder addiert werden:</li>\n</ul>\n<pre><code class=\"language-glsl\">vec3 pos = origin + direction * t;  // Addition + Skalierung\nvec3 rgb = vec3(1.0, 0.5, 0.0);    // Initialisierung eines Vektors\n</code></pre>\n<ul>\n<li>Skalar * Skalar = Skalar, Vektor + Vektor = Vektor, Vektor * Skalar = Vektor</li>\n</ul>\n<hr>\n<h3><strong>If-Abfragen</strong></h3>\n<pre><code class=\"language-glsl\">// if / else if / else für Wertebereiche:\n\nif (wert &lt; grenzeA) {  \n // Aktion 1  \n}  \nelse if (wert &lt; grenzeB) {  \n // Aktion 2  \n}  \nelse {  \n // Standardfall  \n}\n</code></pre>\n<hr>\n<h3><strong>Interpolation / mix</strong></h3>\n<ul>\n<li><code>mix(a, b, t)</code> blendet linear zwischen a und b  </li>\n<li>t = 0 → Ergebnis = a, t = 1 → Ergebnis = b</li>\n</ul>\n<pre><code class=\"language-glsl\">float t = (x - min) / (max - min);  // Normalisierung eines Wertes für mix\n\nvec3 ergebnis = mix(vec3(0.0), vec3(1.0, 0.0, 0.0), t);\n</code></pre>\n<hr>\n<h3><strong>For-Schleifen</strong></h3>\n<p>for-Schleifen wiederholen Schritte:</p>\n<pre><code class=\"language-glsl\">for (int i = 0; i &lt; steps; i++) {  \n float t = float(i) * stepSize;  // int → float für Berechnung  \n // Verarbeitung von t  \n}\n</code></pre>\n<ul>\n<li><code>continue;</code> springt zum nächsten Schleifendurchlauf</li>\n</ul>\n<hr>\n<h3><strong>Überprüfung von Vektoren</strong></h3>\n<p>any() prüft, ob <strong>irgendeine Komponente</strong> einer Bedingung entspricht:</p>\n<pre><code class=\"language-glsl\">if (any(lessThan(pos, vec3(0.0))) || any(greaterThan(pos, vec3(1.0)))) {  \n continue;  // Überspringt ungültige Position  \n}\n</code></pre>\n<hr>\n<h3><strong>SampleVolume</strong></h3>\n<p>SampleVolume berechnet <strong>an einer 3D-Koordinate im Volumen</strong> die benötigten Werte.</p>\n<pre><code class=\"language-glsl\">vec4 sample = SampleVolume(coord, direction);\n</code></pre>\n<ul>\n<li><strong>Inputs:</strong>  <ul>\n<li><code>coord</code> → 3D-Position im normalisierten Raum (0..1)  </li>\n<li><code>direction</code> → Richtungsvektor (für Gradienten / Beleuchtung berechnung)</li>\n</ul>\n</li>\n<li><strong>Output:</strong> <code>vec4</code>  <ul>\n<li><code>rgb</code> → berechnete Farbe / Materialwert  </li>\n<li><code>a</code> → Transparenz / Gewichtung</li>\n</ul>\n</li>\n</ul>\n",
    "theory": "<h2>1. Strahlgenerierung (Orthographisch)</h2>\n<p>Bei einer orthographischen Kamera sind alle Strahlen parallel. Der Startpunkt verschiebt sich basierend auf der Pixelposition auf der Bildebene relativ zur Kameraposition.</p>\n<ul>\n<li><strong>Richtung</strong> (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>D</mi><mo>⃗</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\vec{D}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9663em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9663em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span><span style=\"top:-3.2523em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1799em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\"><path d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\"/></svg></span></span></span></span></span></span></span></span></span></span>): Entspricht konstant dem <code>forward</code> Vektor der Kamera.</li>\n<li><strong>Startpunkt</strong> (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi></mrow><annotation encoding=\"application/x-tex\">O</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span></span></span></span>):\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>O</mi><mo>=</mo><msub><mi>P</mi><mrow><mi>c</mi><mi>a</mi><mi>m</mi><mi>e</mi><mi>r</mi><mi>a</mi></mrow></msub><mo>+</mo><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mrow><mi>R</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi></mrow><mo>⃗</mo></mover><mo>⋅</mo><msub><mi>x</mi><mrow><mi>u</mi><mi>v</mi></mrow></msub><mo>+</mo><mover accent=\"true\"><mrow><mi>U</mi><mi>p</mi></mrow><mo>⃗</mo></mover><mo>⋅</mo><msub><mi>y</mi><mrow><mi>u</mi><mi>v</mi></mrow></msub><mo stretchy=\"false\">)</mo><mo>⋅</mo><mtext>scale</mtext></mrow><annotation encoding=\"application/x-tex\">\nO = P_{camera} + (\\vec{Right} \\cdot x_{uv} + \\vec{Up} \\cdot y_{uv}) \\cdot \\text{scale}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"mord mathnormal mtight\">am</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.02778em;\">er</span><span class=\"mord mathnormal mtight\">a</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.2274em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9774em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">t</span></span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2355em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\"><path d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\"/></svg></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">uv</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1608em;vertical-align:-0.1944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9663em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mord mathnormal\">p</span></span></span><span style=\"top:-3.2523em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2355em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\"><path d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\"/></svg></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">uv</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord text\"><span class=\"mord\">scale</span></span></span></span></span></span>\n<em>(Code-Variablen: <code>pixelPos.x</code> entspricht <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mrow><mi>u</mi><mi>v</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">x_{uv}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">uv</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>, <code>orthoScale</code> entspricht scale)</em></li>\n</ul>\n<h2>2. Raymarching Loop (Back-to-Front)</h2>\n<p>Wir laufen den Strahl von hinten nach vorne ab. Der Parameter <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span> läuft in der Schleife von <code>maxSteps</code> (bzw. 1.0) runter auf <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span>.</p>\n<ul>\n<li><strong>Position auf dem Strahl</strong>:\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>O</mi><mo>+</mo><mi>t</mi><mo>⋅</mo><mover accent=\"true\"><mi>D</mi><mo>⃗</mo></mover></mrow><annotation encoding=\"application/x-tex\">\nP(t) = O + t \\cdot \\vec{D}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7667em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9663em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9663em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">D</span></span><span style=\"top:-3.2523em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1799em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\"><path d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\"/></svg></span></span></span></span></span></span></span></span></span></span></span></li>\n<li><strong>Textur-Koordinate</strong>:\nDa der Volumenwürfel im Weltraum um <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(0,0,0)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span> zentriert ist, Texturen aber Koordinaten von <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span> bis <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span> erwarten, müssen wir verschieben:\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mrow><mi>U</mi><mi>V</mi><mi>W</mi></mrow><mo>⃗</mo></mover><mo>=</mo><mi>P</mi><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mn>0.5</mn></mrow><annotation encoding=\"application/x-tex\">\n\\vec{UVW} = P(t) + 0.5\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9663em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9663em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">VW</span></span></span><span style=\"top:-3.2523em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2355em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\"><path d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\"/></svg></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.5</span></span></span></span></span></li>\n<li><strong>Bounds Check</strong>:\nSamples sind nur gültig, wenn <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mrow><mi>U</mi><mi>V</mi><mi>W</mi></mrow><mo>⃗</mo></mover><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\vec{UVW} \\in [0, 1]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.0054em;vertical-align:-0.0391em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9663em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">U</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">VW</span></span></span><span style=\"top:-3.2523em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2355em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\"><path d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\"/></svg></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span>. Liegt der Punkt außerhalb, wird er ignoriert (<code>continue</code>).</li>\n</ul>\n<h2>3. Compositing (Over Operator)</h2>\n<p>Das Mischen der Farben erfolgt iterativ. Da wir von hinten nach vorne laufen, &quot;übermalen&quot; wir die bisherige Farbe mit der neuen Schicht, gewichtet nach deren Transparenz.</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>C</mi><mrow><mi>a</mi><mi>c</mi><mi>c</mi></mrow></msub><mo>=</mo><msub><mi>C</mi><mrow><mi>s</mi><mi>r</mi><mi>c</mi></mrow></msub><mo>⋅</mo><msub><mi>α</mi><mrow><mi>s</mi><mi>r</mi><mi>c</mi></mrow></msub><mo>+</mo><msub><mi>C</mi><mrow><mi>a</mi><mi>c</mi><mi>c</mi></mrow></msub><mo>⋅</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><msub><mi>α</mi><mrow><mi>s</mi><mi>r</mi><mi>c</mi></mrow></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\nC_{acc} = C_{src} \\cdot \\alpha_{src} + C_{acc} \\cdot (1 - \\alpha_{src})\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">cc</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">src</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">src</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">cc</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">src</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span></p>\n<ul>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mrow><mi>a</mi><mi>c</mi><mi>c</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">C_{acc}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mord mathnormal mtight\">cc</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>: Bisher akkumulierte Farbe (Variable <code>accumulatedColor</code>).</li>\n<li><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>C</mi><mrow><mi>s</mi><mi>r</mi><mi>c</mi></mrow></msub><mo separator=\"true\">,</mo><msub><mi>α</mi><mrow><mi>s</mi><mi>r</mi><mi>c</mi></mrow></msub></mrow><annotation encoding=\"application/x-tex\">C_{src}, \\alpha_{src}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">src</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0037em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">src</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>: Farbe und Alpha des aktuellen Voxels (Rückgabe von <code>SampleVolume</code>).</li>\n</ul>\n<h2>4. Transfer Function</h2>\n<p>Die Dichte (HU) bestimmt das Material. Wir interpolieren linear zwischen den bekannten Stützstellen.</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">Material</th>\n<th align=\"left\">HU Wert (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>F</mi></mrow><annotation encoding=\"application/x-tex\">F</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span></span></span></span>)</th>\n<th align=\"left\">Farbe</th>\n<th align=\"left\">Opazität (<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span>)</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\"><strong>Luft</strong></td>\n<td align=\"left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≤</mo><mtext>huAir</mtext></mrow><annotation encoding=\"application/x-tex\">\\le \\text{huAir}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord text\"><span class=\"mord\">huAir</span></span></span></span></span></td>\n<td align=\"left\">Schwarz (0,0,0)</td>\n<td align=\"left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>0.0</mn></mrow><annotation encoding=\"application/x-tex\">0.0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.0</span></span></span></span></td>\n</tr>\n<tr>\n<td align=\"left\"><strong>Gewebe</strong></td>\n<td align=\"left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>…</mo><mtext>huTissue</mtext></mrow><annotation encoding=\"application/x-tex\">\\dots \\text{huTissue}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord text\"><span class=\"mord\">huTissue</span></span></span></span></span></td>\n<td align=\"left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> <code>colorTissue</code></td>\n<td align=\"left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">→</span></span></span></span> <code>alphaTissue</code></td>\n</tr>\n<tr>\n<td align=\"left\"><strong>Knochen</strong></td>\n<td align=\"left\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≥</mo><mtext>huBone</mtext></mrow><annotation encoding=\"application/x-tex\">\\ge \\text{huBone}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7719em;vertical-align:-0.136em;\"></span><span class=\"mrel\">≥</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord text\"><span class=\"mord\">huBone</span></span></span></span></span></td>\n<td align=\"left\"><code>colorBone</code></td>\n<td align=\"left\"><code>alphaBone</code></td>\n</tr>\n</tbody></table>\n<p><em>Berechnen Sie für Bereiche zwischen den Werten einen Faktor <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>t</mi></mrow><annotation encoding=\"application/x-tex\">t</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6151em;\"></span><span class=\"mord mathnormal\">t</span></span></span></span> (0 bis 1) und nutzen Sie <code>mix</code>.</em></p>\n",
    "referenceVertexShader": "precision highp float;\n\nin vec3 position;\nin vec2 uv;\n\nout vec2 vUv;\n\nvoid main() {\n    vUv = uv * 2.0 - 1.0;\n    gl_Position = vec4(position, 1.0);\n}",
    "referenceFragmentShader": "precision highp float;\nprecision highp sampler3D;\n\nin vec2 vUv;\nout vec4 fragColor;\n\nuniform vec3 cameraPosition;\nuniform vec3 cameraDirection;\nuniform sampler3D volumeTexture;\nuniform ivec2 iResolution;\n\n// Parameter aus der Vorlesung\nconst float stepSize = 0.00256;\nconst int   maxSteps = 512;\nconst vec3  lightDir = normalize(vec3(1.0, 1.0, 0.0));\nconst float orthoScale = 0.5;\n\nvec3 ComputeGradient(vec3 samplePosition) {\n    vec3 H = 1.0 / vec3(textureSize(volumeTexture, 0)); \n    float Fx1 = texture(volumeTexture, clamp(samplePosition + vec3(H.x, 0.0, 0.0), 0.0, 1.0)).r;\n    float Fx2 = texture(volumeTexture, clamp(samplePosition - vec3(H.x, 0.0, 0.0), 0.0, 1.0)).r;\n    float Fy1 = texture(volumeTexture, clamp(samplePosition + vec3(0.0, H.y, 0.0), 0.0, 1.0)).r;\n    float Fy2 = texture(volumeTexture, clamp(samplePosition - vec3(0.0, H.y, 0.0), 0.0, 1.0)).r;\n    float Fz1 = texture(volumeTexture, clamp(samplePosition + vec3(0.0, 0.0, H.z), 0.0, 1.0)).r;\n    float Fz2 = texture(volumeTexture, clamp(samplePosition - vec3(0.0, 0.0, H.z), 0.0, 1.0)).r;\n    vec3 grad = vec3((Fx1 - Fx2), (Fy1 - Fy2), (Fz1 - Fz2)) / (2.0 * H);\n    return grad;\n}\n\nvec4 TransferFunction(float density, float gradientMagnitude)\n{\n    const float huAir    = -800.0;\n    const float huTissue =   50.0;\n    const float huBone   =  700.0;\n\n    const float alphaAir    = 0.0;\n    const float alphaTissue = 0.03;\n    const float alphaBone   = 1.0;\n\n    const vec3 colorAir    = vec3(0.0);\n    const vec3 colorTissue = vec3(0.929, 0.675, 0.522);\n    const vec3 colorBone   = vec3(0.949, 0.898, 0.643);\n\n    float alpha;\n    vec3  color;\n    \n    if (density <= huAir) {\n        alpha = alphaAir;\n        color = colorAir;\n    } \n    else if (density < huTissue) {\n        float t = (density - huAir) / (huTissue - huAir);\n        alpha = mix(alphaAir, alphaTissue, t);\n        color = mix(colorAir, colorTissue, t);\n    } \n    else if (density < huBone) {\n        float t = (density - huTissue) / (huBone - huTissue);\n        alpha = mix(alphaTissue, alphaBone, t);\n        color = mix(colorTissue, colorBone, t);\n    } \n    else {\n        alpha = alphaBone;\n        color = colorBone;\n    }\n\n    // Gradient Modulation (Levoy)\n    alpha *= 1.0 - exp(-5.0 * clamp(gradientMagnitude / 8.0, 0.0, 1.0));\n\n    return vec4(color, alpha);\n}\n\nvec3 PhongShade(vec3 N, vec3 BaseColor, vec3 ViewDir, vec3 lightDir) {\n    const vec3 Ka = vec3(0.01); \n    const vec3 Kd = vec3(1.0); \n    const vec3 Ks = vec3(0.3); \n    const float NExp = 120.0; \n\n    vec3 H = normalize(ViewDir + lightDir); \n    float Diff = max(dot(N, lightDir), 0.0); \n    float Spec = pow(max(dot(N, H), 0.0), NExp); \n\n    return BaseColor * (Ka + Kd * Diff) + Ks * Spec;\n}\n\nvoid GenerateRay(out vec3 rayOrigin, out vec3 rayDirection) {\n    float Aspect = float(iResolution.x) / float(iResolution.y); \n    vec2 pixelPos = vUv;\n    pixelPos.x *= Aspect; \n\n    vec3 forward = normalize(cameraDirection);\n    vec3 right = normalize(cross(forward, vec3(0.0, 1.0, 0.0)));\n    vec3 up = cross(right, forward);\n\n    rayDirection = forward;\n    rayOrigin = cameraPosition + pixelPos.x * right * orthoScale + pixelPos.y * up * orthoScale; \n}\n\nvec4 SampleVolume(vec3 textureCoord, vec3 rayDirection) {\n    float rawValue = texture(volumeTexture, textureCoord).r;\n    float density = rawValue - 1100.0; // HU Offset\n    \n    vec3 gradient = ComputeGradient(textureCoord); \n    float gradMag = length(gradient);\n\n    vec4 material = TransferFunction(density, gradMag); \n    \n    vec3 shadedColor = PhongShade(normalize(-gradient), material.rgb, normalize(-rayDirection), lightDir); \n\n    return vec4(shadedColor, material.a); \n}\n\nvec3 Raymarch(vec3 rayOrigin, vec3 rayDirection) {\n    vec3 accumulatedColor = vec3(0.0);\n    int totalSteps = min(int(1.0 / stepSize), maxSteps);\n\n    for (int i = totalSteps - 1; i >= 0; --i) {     \n        float t = float(i) * stepSize;         \n        vec3 currentPosition = rayOrigin + rayDirection * t;\n        vec3 textureCoord = currentPosition + 0.5;\n\n        if (textureCoord.x < 0.0 || textureCoord.y < 0.0 || textureCoord.z < 0.0 || \n            textureCoord.x > 1.0 || textureCoord.y > 1.0 || textureCoord.z > 1.0)\n            continue;\n\n        vec4 src = SampleVolume(textureCoord, rayDirection);\n        accumulatedColor = src.rgb * src.a + accumulatedColor * (1.0 - src.a);\n    }\n    return accumulatedColor;\n}\n\nvoid main() {\n    vec3 rayOrigin, rayDirection;\n    GenerateRay(rayOrigin, rayDirection);\n\n    vec3 finalColor = Raymarch(rayOrigin, rayDirection);\n\n    fragColor = vec4(finalColor, 1.0);\n}",
    "starterVertexShader": "precision highp float;\n\nin vec3 position;\nin vec2 uv;\n\nout vec2 vUv;\n\nvoid main() {\n    vUv = uv * 2.0 - 1.0;\n    gl_Position = vec4(position, 1.0);\n}",
    "starterFragmentShader": "precision highp float;\nprecision highp sampler3D;\n\nin vec2 vUv;\nout vec4 fragColor;\n\n// Uniforms\nuniform vec3 cameraPosition;\nuniform vec3 cameraDirection;\nuniform sampler3D volumeTexture;\nuniform ivec2 iResolution;\n\n// Konstanten\nconst float stepSize = 0.00256;\nconst int   maxSteps = 512;\nconst vec3  lightDir = normalize(vec3(1.0, 1.0, 0.0));\nconst float orthoScale = 0.5;\n\n//  Helper Functions (Bereits implementiert) \n\nvec3 ComputeGradient(vec3 samplePosition) {\n    // Zentraler Differenzenquotient zur Bestimmung der Normale\n    vec3 H = 1.0 / vec3(textureSize(volumeTexture, 0));\n    float Fx1 = texture(volumeTexture, clamp(samplePosition + vec3(H.x, 0.0, 0.0), 0.0, 1.0)).r;\n    float Fx2 = texture(volumeTexture, clamp(samplePosition - vec3(H.x, 0.0, 0.0), 0.0, 1.0)).r;\n    float Fy1 = texture(volumeTexture, clamp(samplePosition + vec3(0.0, H.y, 0.0), 0.0, 1.0)).r;\n    float Fy2 = texture(volumeTexture, clamp(samplePosition - vec3(0.0, H.y, 0.0), 0.0, 1.0)).r;\n    float Fz1 = texture(volumeTexture, clamp(samplePosition + vec3(0.0, 0.0, H.z), 0.0, 1.0)).r;\n    float Fz2 = texture(volumeTexture, clamp(samplePosition - vec3(0.0, 0.0, H.z), 0.0, 1.0)).r;\n    return vec3((Fx1 - Fx2), (Fy1 - Fy2), (Fz1 - Fz2)) / (2.0 * H);\n}\n\nvec3 PhongShade(vec3 N, vec3 BaseColor, vec3 ViewDir) {\n    // Blinn-Phong Beleuchtungsmodell\n    const vec3 Ka = vec3(0.01); const vec3 Kd = vec3(1.0); const vec3 Ks = vec3(0.3); float NExp = 120.0;\n    vec3 H = normalize(ViewDir + lightDir);\n    return BaseColor * (Ka + Kd * max(dot(N, lightDir), 0.0)) + Ks * pow(max(dot(N, H), 0.0), NExp);\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n// --------------------------------------------------\n//  TASK 3: Transfer Function \n// --------------------------------------------------\nvec4 TransferFunction(float density, float gradientMagnitude) {\n    // Referenzwerte HU (Hounsfield Units)\n    const float huAir    = -800.0;\n    const float huTissue =   50.0;\n    const float huBone   =  700.0;\n\n    // Zielwerte\n    const float alphaTissue = 0.03;\n    const float alphaBone   = 1.0;\n    const vec3 colorTissue  = vec3(0.929, 0.675, 0.522);\n    const vec3 colorBone    = vec3(0.949, 0.898, 0.643);\n\n    vec3 color = vec3(1.0); // Default Weiß\n    float alpha = 0.0;      // Default Transparent\n\n\n    if (density <= huAir) {\n        alpha = 0.0;\n        color = vec3(0.0);\n    }\n\n\n    // TODO: Implementieren Sie die Klassifizierung für die Zielwerte oben\n\n\n    else {\n        alpha = alphaBone;\n        color = colorBone;\n    }\n\n\n\n    // Fallback für Task 2 (Silhouetten-Modus):\n    // Wenn die TransferFunction noch leer ist (alpha 0), aber Dichte da ist, mach es weiß.\n    if (alpha == 0.0 && density > huAir) { alpha = 0.1; } \n\n    return vec4(color, alpha);\n}\n\n\n\n\n\n\n// SampleVolume berechnet **an einer 3D-Koordinate im Volumen** die benötigten Werte.\n// samplePosition → Koordinate im Volumen\n// rayDirection → Richtungsvektor (für Gradienten / Beleuchtung berechnung)\n// return → vec4, rgb = Farbe, a = Opazität\nvec4 SampleVolume(vec3 samplePosition, vec3 rayDirection) {\n    float rawValue = texture(volumeTexture, samplePosition).r;\n    float density = rawValue - 1100.0; // Korrektur der Rohdaten\n    \n    vec3 gradient = ComputeGradient(samplePosition);\n    \n    vec4 material = TransferFunction(density, length(gradient));\n    \n    // Kantenverstärkung (Levoy)\n    material.a *= (1.0 - exp(-5.0 * length(gradient))); \n\n    vec3 shadedColor = PhongShade(normalize(-gradient), material.rgb, -rayDirection);\n    return vec4(shadedColor, material.a);\n}\n\n\n\n\n// --------------------------------------------------\n//  TASK 2: Raymarching Loop \n// --------------------------------------------------\nvec3 Raymarch(vec3 rayOrigin, vec3 rayDirection) {\n\n    int totalSteps = min(int(1.0 / stepSize), maxSteps);\n\n    // Sobald Sie Task 2 beginnen, ändern Sie dies auf vec3(0.0) (Schwarz).\n    vec3 accumulatedColor = vec3(-1.0);\n\n    // TODO: Implementieren Sie die Raymarching Schleife (Siehe Theory Abschnitt 2 & 3)\n    \n    return accumulatedColor;\n}\n\n\n\n\n// --------------------------------------------------\n//  TASK 1: Ray Generation \n// --------------------------------------------------\nvoid GenerateRay(out vec3 rayOrigin, out vec3 rayDirection) {\n    float Aspect = float(iResolution.x) / float(iResolution.y);\n    vec2 pixelPos = vUv;\n    pixelPos.x *= Aspect;\n\n    // Basisvektoren der Kamera\n    vec3 forward = normalize(cameraDirection);\n    vec3 right = normalize(cross(forward, vec3(0.0, 1.0, 0.0)));\n    vec3 up = cross(right, forward);\n\n    // TODO: Berechnen Sie Strahlstartpunkt und Richtung für Orthographische Projektion (Siehe Theory Abschnitt 1)\n    \n    rayDirection = vec3(0.0); // Platzhalter\n    rayOrigin = vec3(0.0);    // Platzhalter\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvoid main() {\n    vec3 rayOrigin, rayDirection;\n    GenerateRay(rayOrigin, rayDirection);\n\n    // Wir rufen den Loop immer auf.\n    // Wenn er noch nicht implementiert ist, kommt der Sentinel (-1.0) zurück.\n    vec3 resultColor = Raymarch(rayOrigin + 0.5, rayDirection); // +0.5 um den Kopf in den Ursprung zu verschieben\n\n    //  AUTOMATISCHE VORSCHAU \n    \n    // ZUSTAND 3: Sentinel (-1.0) wurde im Loop überschrieben -> Task 2 ist aktiv!\n    // Wir zeigen das Ergebnis (Schwarz oder Bunt)\n    if (resultColor.x >= 0.0) {\n        fragColor = vec4(resultColor, 1.0);\n    } \n    // ZUSTAND 2: RayGen ist implementiert (Richtung != 0), aber Loop fehlt noch (Sentinel -1)\n    // Wir zeigen die Ray-Origin als Debug-Farbe.\n    else if (length(rayDirection) > 0.0) {\n        fragColor = vec4(rayOrigin * 0.5 + 0.5, 1.0);\n    } \n    // ZUSTAND 1: Startzustand\n    else {\n        fragColor = vec4(vUv * 0.5 + 0.5, 0.0, 1.0); \n    }\n}"
  },
  {
    "category": "Grundlagen Computergrafik",
    "type": "3D",
    "title": "Zahnräder",
    "modelPath": "models/Gear.glb",
    "instanceCount": 3,
    "hints": [
      "Verwende gl_InstanceID, um zwischen den Zahnrädern im Shader zu unterscheiden.",
      {
        "Die Reihenfolge der Matrixmultiplikation ist entscheidend": "Translation * Rotation * Skalierung wendet die Skalierung zuerst an."
      },
      "Um eine Hierarchie (z. B. Zahnrad C greift in B ein) zu erzeugen, multipliziere die Transformationen der Zahnräder abhängig voneinander.",
      "Benutze den time-Uniform, um die Rotationen zu animieren."
    ],
    "task": "<p>Erstelle ein hierarchisches System aus drei Zahnrädern (A, B, C).<br>Alle Zahnräder sollen sich um ihre jeweilige Achse drehen, und die Drehungen sollen so abgestimmt sein, dass sie korrekt ineinandergreifen.<br>Die Transformationen werden ausschließlich im <strong>Vertex Shader</strong> unter Verwendung von Matrizen und dem <strong>gl_InstanceID</strong> berechnet.</p>\n",
    "theory": "<p>Zahnräder sind ein klassisches Beispiel für gekoppelte, gegenläufige Rotationen.<br>Wenn Zahnrad A sich im Uhrzeigersinn dreht, muss Zahnrad B sich entgegengesetzt drehen, und Zahnrad C wiederum entgegengesetzt zu B.<br>Diese Bewegung kann durch Rotationsmatrizen im Shader simuliert werden.</p>\n<p>Die finale Matrix für jedes Zahnrad setzt sich zusammen aus: finalMatrix = projectionMatrix * viewMatrix * translation * rotation * scale</p>\n<p>Um Abhängigkeiten (z. B. Zahnrad C hängt an B) zu simulieren:</p>\n<p>finalCMatrix = projectionMatrix * viewMatrix * transformB * localCMatrix</p>\n",
    "starterVertexShader": "precision highp float;\n\nin vec3 position;\nin vec3 normal;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float time;\n\nout vec3 vNormal;\nout vec3 vColor;\n\nvoid main() {\n    mat4 modelMatrix = mat4(1.0);\n\n    if (gl_InstanceID == 0) {\n        // --- Zahnrad A ---\n\n    } else if (gl_InstanceID == 1) {\n        // --- Zahnrad B ---\n\n    } else if (gl_InstanceID == 2) {\n        // --- Zahnrad C ---\n\n    }\n\n    vColor = vec3(1.0);\n    vNormal = normal;\n    gl_Position = projectionMatrix * modelViewMatrix * modelMatrix * vec4(position, 1.0);\n}",
    "starterFragmentShader": "precision highp float;\n\nin vec3 vNormal;\nin vec3 vColor;\n\nout vec4 fragColor;\n\nvoid main() {\n    vec3 lightDir = normalize(vec3(1.0, 0.5, 1.0));\n    float diffuse = max(dot(normalize(vNormal), lightDir), 0.0);\n    float ambient = 0.2;\n    vec3 finalColor = vColor * (diffuse + ambient);\n    fragColor = vec4(finalColor, 1.0);\n}",
    "referenceVertexShader": "precision highp float;\n\nin vec3 position;\nin vec3 normal;\n\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float time;\n\nout vec3 vNormal;\nout vec3 vColor;\n\n// Helper functions\nmat4 translation(vec3 t) {\n    return mat4(\n        1.0, 0.0, 0.0, 0.0,\n        0.0, 1.0, 0.0, 0.0,\n        0.0, 0.0, 1.0, 0.0,\n        t.x, t.y, t.z, 1.0\n    );\n}\n\nmat4 scale(vec3 s) {\n    return mat4(\n        s.x, 0.0, 0.0, 0.0,\n        0.0, s.y, 0.0, 0.0,\n        0.0, 0.0, s.z, 0.0,\n        0.0, 0.0, 0.0, 1.0\n    );\n}\n\nmat4 rotationX(float angle) {\n    float c = cos(angle);\n    float s = sin(angle);\n    return mat4(\n        1.0, 0.0, 0.0, 0.0,\n        0.0, c, -s, 0.0,\n        0.0, s,  c, 0.0,\n        0.0, 0.0, 0.0, 1.0\n    );\n}\n\nvoid main() {\n    mat4 modelMatrix = mat4(1.0);\n\n    // Radii for spacing\n    float radiusA = 2.0;\n    float radiusB = 1.0;\n    float radiusC = 1.5;\n\n    if (gl_InstanceID == 0) {\n        // --- Zahnrad A ---\n        vColor = vec3(1.0, 0.4, 0.2);\n        mat4 sA = scale(vec3(2.0));\n        mat4 rotA = rotationX(time * 0.2 * 6.2831);\n        mat4 transA = translation(vec3(0.0, -0.5, 0.0));\n        modelMatrix = transA * rotA * sA;\n\n    } else if (gl_InstanceID == 1) {\n        // --- Zahnrad B ---\n        vColor = vec3(0.2, 0.6, 1.0);\n        mat4 sB = scale(vec3(1.0));\n        mat4 rotB = rotationX(-time * 0.4 * 6.2831);\n        // place B right next to A\n        mat4 transB = translation(vec3(0.0, radiusA + radiusB, 0.0));\n        modelMatrix = transB * rotB * sB;\n\n    } else if (gl_InstanceID == 2) {\n        // --- Zahnrad C ---\n        vColor = vec3(0.7, 0.8, 0.2);\n        mat4 sC = scale(vec3(1.5));\n        mat4 rotC = rotationX(time * 0.6 * 6.2831);\n        // place C right next to B\n        float yB = radiusA + radiusB + 0.5;\n        float yC = yB + radiusB + radiusC; // sum distances\n        mat4 transC = translation(vec3(0.0, yC, 0.0));\n        modelMatrix = transC * rotC * sC;\n    }\n\n    // Normals korrekt transformieren\n    mat3 normalMatrix = mat3(transpose(inverse(modelMatrix)));\n    vNormal = normalize(normalMatrix * normal);\n\n    gl_Position = projectionMatrix * modelViewMatrix * modelMatrix * vec4(position, 1.0);\n}",
    "referenceFragmentShader": "precision highp float;\n\nin vec3 vNormal;\nin vec3 vColor;\n\nout vec4 fragColor;\n\nvoid main() {\n    vec3 lightDir = normalize(vec3(1.0, 0.5, 1.0));\n    float diffuse = max(dot(normalize(vNormal), lightDir), 0.0);\n    float ambient = 0.2;\n    vec3 finalColor = vColor * (diffuse + ambient);\n    fragColor = vec4(finalColor, 1.0);\n}"
  }
]